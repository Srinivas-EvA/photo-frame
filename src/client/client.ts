import * as THREE from 'three';
import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';
import { RGBELoader } from 'three/examples/jsm/loaders/RGBELoader';
import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';
import { GUI } from 'three/examples/jsm/libs/dat.gui.module'

let camera: THREE.OrthographicCamera
let scene: THREE.Scene;
let renderer: THREE.WebGLRenderer;
let gui;


const state = { variant: 'midnight' };

init();
render();

function init() {

    const container = document.createElement( 'div' );
    document.body.appendChild( container );

    scene = new THREE.Scene();

    let orthoHeight = 5000;
    const orthoAspect = window.innerWidth / window.innerHeight;

    camera = new THREE.OrthographicCamera(
        -orthoHeight * orthoAspect,
        orthoHeight * orthoAspect,
        orthoHeight,
        -orthoHeight,
        -10000000,
        10000000
    );

    scene.add(camera);
    camera.position.set(0, 0, 100000);
    camera.zoom = 6;

    renderer = new THREE.WebGLRenderer({
        antialias: true
      });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setClearColor(0xeeeeee);
    container.appendChild( renderer.domElement );

    const controls = new OrbitControls( camera, renderer.domElement );
    controls.addEventListener( 'change', render ); // use if there is no animation loop
    controls.target.set( 0, 0, 0);
    controls.update();

    //Lights
    let light = new THREE.DirectionalLight('white', 0.5);
    scene.add(light);
    light.position.set(100, 100, 100);

    light = new THREE.DirectionalLight('white', 0.5);
    scene.add(light);
    light.position.set(-100, 100, 100);

    let abLight = new THREE.AmbientLight('white');
    scene.add(abLight);

    createOurModel();

    window.addEventListener( 'resize', onWindowResize );
}

function createOurModel() {
    let shape = new THREE.Shape();
    shape.moveTo( 1.4408920985007904e-16 , 207.50000000000233 )
    shape.lineTo( 1.4408920985007904e-16 , 2.500000000002276 )
    shape.absarc( 2.4999999999999907 , 2.5000000000022635 , 2.4999999999999907 , 3.1415926535897882 , 4.712388980384466 , false )
    shape.lineTo( 13.964462399071634 , 0 )
    shape.absarc( 13.964462399071314 , 2.5000089204785283 , 2.5000089204785287 , 4.712388980384818 , 5.497786436674097 , false )
    shape.lineTo( 19.267763822444973 , 4.267758822456925 )
    shape.absarc( 17.499993579530617 , 6.035531565389291 , 2.5000064204693753 , 5.4977864366720794 , 1.9837465004002297e-12 , false )
    shape.lineTo( 19.999999999981803 , 9.500001120618421 )
    shape.absarc( 18.50000112060521 , 9.500001120617945 , 1.4999988793765913 , 3.170796958329447e-13 , 1.5707963267957066 , false )
    shape.lineTo( 13.999998879389743 , 10.999999999978606 )
    shape.absarc( 13.999998879389745 , 12.499998879368357 , 1.4999988793897514 , 4.712388980384689 , 3.1415926535860472 , true )
    shape.lineTo( 12.499999999999993 , 30.000003735381135 )
    shape.absarc( 17.499996264618844 , 30.0000037353857 , 4.999996264618849 , 3.141592653590706 , 1.5707963267957343 , true )
    shape.lineTo( 62.50000373536751 , 34.999999999999964 )
    shape.absarc( 62.50000373536734 , 30.00000373537186 , 4.999996264628108 , 1.5707963267948637 , 6.292744103575387e-13 , true )
    shape.lineTo( 67.5 , 12.499998879391097 )
    shape.absarc( 66.00000112060957 , 12.499998879389524 , 1.499998879390438 , 1.0480505352461478e-12 , 4.712388980385372 , true )
    shape.lineTo( 61.49999887938976 , 10.999999999999087 )
    shape.absarc( 61.499998879389615 , 9.500001120614028 , 1.4999988793850592 , 1.5707963267948017 , 3.1415926535881957 , false )
    shape.lineTo( 60.00000000000001 , 6.035537600926077 )
    shape.absarc( 62.500008920474606 , 6.035537600910279 , 2.5000089204745994 , 3.1415926535834737 , 3.926991802965067 , false )
    shape.lineTo( 63.26777285095886 , 1.732232149026909 )
    shape.absarc( 65.03554010090544 , 3.500002884954672 , 2.5000028849555886 , 3.926991802970479 , 4.7123889803847865 , false )
    shape.lineTo( 79.96446239905708 , 0.9999999999899879 )
    shape.absarc( 79.96446239905836 , 3.50000892045543 , 2.5000089204654423 , 4.712388980384178 , 5.497786157795065 , false )
    shape.lineTo( 84.26776332944428 , 4.2677583294698636 )
    shape.absarc( 82.49999357951445 , 6.035531565395754 , 2.50000642047633 , 5.497786157796088 , 3.1787905641067482e-12 , false )
    shape.lineTo( 84.99999999998181 , 9.500001120616155 )
    shape.absarc( 83.50000112060538 , 9.500001120618082 , 1.4999988793764334 , 6.283185307178302 , 1.5707963267958154 , false )
    shape.lineTo( 78.99999887938975 , 10.999999999978606 )
    shape.absarc( 78.99999887938681 , 12.499998879365409 , 1.4999988793868029 , 4.712388980386651 , 3.1415926535878285 , true )
    shape.lineTo( 77.5 , 32.500001867676936 )
    shape.absarc( 79.99999813231649 , 32.50000186767671 , 2.49999813231649 , 3.141592653589702 , 1.5707963267950842 , true )
    shape.lineTo( 220.0000018677019 , 35.00000000000453 )
    shape.absarc( 220.00000186770197 , 32.500001867697506 , 2.4999981323070277 , 1.5707963267949192 , 6.28318530717943 , true )
    shape.lineTo( 222.49999999999991 , 12.499998879388807 )
    shape.absarc( 221.00000112061014 , 12.49999887938883 , 1.4999988793897725 , 6.283185307179571 , 4.7123889803844055 , true )
    shape.lineTo( 216.4999988793896 , 11.000000000003597 )
    shape.absarc( 216.49999887938873 , 9.500001120614794 , 1.4999988793888033 , 1.570796326794309 , 3.141592653589077 , false )
    shape.lineTo( 214.99999999999991 , 6.03553156540326 )
    shape.absarc( 217.5000064204707 , 6.035531565398269 , 2.5000064204707737 , 3.141592653587797 , 3.9269918029726893 , false )
    shape.lineTo( 218.2677660832086 , 1.732233916784462 )
    shape.absarc( 220.03553760091594 , 3.5000089205040017 , 2.500008920502659 , 3.9269918029768722 , 4.712388980387873 , false )
    shape.lineTo( 234.9644598990743 , 0.9999999999967949 )
    shape.absarc( 234.96445989907437 , 3.500002884918587 , 2.500002884921792 , 4.712388980384667 , 5.497786157792492 , false )
    shape.lineTo( 239.26776259720992 , 4.267762597203252 )
    shape.absarc( 237.49999107951982 , 6.035537600908107 , 2.5000089204801115 , 5.497786157791789 , 6.283185307179492 , false )
    shape.lineTo( 239.99999999999991 , 9.50000112061386 )
    shape.absarc( 238.50000112061 , 9.500001120613675 , 1.499998879389922 , 1.2301271112846734e-13 , 1.570796326797625 , false )
    shape.lineTo( 233.9999988793896 , 10.999999999992236 )
    shape.absarc( 233.99999887938964 , 12.499998879381957 , 1.499998879389721 , 4.712388980384671 , 3.1415926535877268 , true )
    shape.lineTo( 232.49999999999991 , 30.000003735381107 )
    shape.absarc( 237.4999962646187 , 30.00000373538574 , 4.9999962646187885 , 3.1415926535907195 , 1.5707963267957492 , true )
    shape.lineTo( 282.5000037353676 , 34.99999999999996 )
    shape.absarc( 282.50000373536136 , 30.0000037353795 , 4.999996264620455 , 1.5707963267936458 , 6.283185307178997 , true )
    shape.lineTo( 287.4999999999999 , 12.499998879391086 )
    shape.absarc( 286.0000011206095 , 12.499998879389468 , 1.4999988793904118 , 1.078692690725802e-12 , 4.712388980385372 , true )
    shape.lineTo( 281.49999887938964 , 10.999999999999057 )
    shape.absarc( 281.4999988793868 , 9.500001120612152 , 1.499998879386903 , 1.5707963267930016 , 3.1415926535856236 , false )
    shape.lineTo( 279.9999999999999 , 6.035531565375968 )
    shape.absarc( 282.5000064204696 , 6.035531565369044 , 2.5000064204697487 , 3.1415926535870233 , 3.926991524096281 , false )
    shape.lineTo( 284.2677655902115 , 0.7322344097746899 )
    shape.absarc( 286.03553760090193 , 2.500008920495495 , 2.5000089204909766 , 3.926991524100097 , 4.712388980387918 , false )
    shape.lineTo( 291.7677688004551 , 2.245e-12 )
    shape.lineTo( 297.4999999999999 , 2.245e-12 )
    shape.absarc( 297.4999999999999 , 2.500000000002245 , 2.5 , 4.71238898038469 , 6.283185307179586 , false )
    shape.lineTo( 300.00000000000324 , 284.73008057878354 )
    shape.absarc( 292.49999999999807 , 284.7300805787823 , 7.500000000005121 , 1.6653345369377348e-13 , 1.221730476396186 , false )
    shape.lineTo( 245.0000000000001 , 310.0000000000022 )
    shape.lineTo( 232.5 , 310.0000000000022 )
    shape.absarc( 232.50000000000006 , 307.50000000000205 , 2.500000000000166 , 1.5707963267949192 , 3.1415926535897247 , false )
    shape.lineTo( 229.99999999998911 , 292.2855338441015 )
    shape.absarc( 232.50000642047306 , 292.2855338441097 , 2.5000064204839436 , 3.1415926535930674 , 3.926991910829971 , false )
    shape.lineTo( 233.0177662738834 , 288.23223600482345 )
    shape.absarc( 234.78553760091174 , 290.0000111991734 , 2.5000089204685514 , 3.9269919108270765 , 4.712388980391317 , false )
    shape.lineTo( 235.9999985599461 , 287.5000022787139 )
    shape.absarc( 235.99999855994656 , 289.00000371876746 , 1.500001440053538 , 4.712388980384387 , 6.283185307172159 , false )
    shape.lineTo( 237.5000000000001 , 296.50000000001734 )
    shape.absarc( 238.9999999999957 , 296.5000000000175 , 1.4999999999956013 , 3.141592653589907 , 1.5707963267944984 , true )
    shape.lineTo( 242.8840762314758 , 298.00000000000875 )
    shape.lineTo( 250.8550503583138 , 295.09880267973125 )
    shape.absarc( 249.9999999999998 , 292.74957112776633 , 2.5000000000001177 , 1.2217304763961143 , 4.0900616227190767e-13 , true )
    shape.lineTo( 252.49999999999991 , 270.00000041102095 )
    shape.absarc( 250.0000018676837 , 270.0000004110211 , 2.4999981323162146 , 6.283185307179519 , 4.712388980384701 , true )
    shape.lineTo( 239.9999981323163 , 267.5000022787049 )
    shape.absarc( 239.9999981323163 , 270.00000041102106 , 2.499998132316188 , 4.71238898038469 , 3.1415926535898158 , true )
    shape.lineTo( 237.5000000000001 , 273.50000339931444 )
    shape.absarc( 236.00000112061187 , 273.50000339931654 , 1.4999988793882675 , 6.283185307178185 , 1.5707963267838687 , false )
    shape.lineTo( 234.78553760093553 , 275.00000227871556 )
    shape.absarc( 234.78553760091557 , 272.4999933582479 , 2.5000089204676756 , 1.5707963267869156 , 2.3561933963576465 , false )
    shape.lineTo( 230.73223686119692 , 271.98224413989215 )
    shape.absarc( 232.5000064204633 , 270.2144707132959 , 2.5000064204814927 , 2.3561933963490844 , 3.1415926535848135 , false )
    shape.lineTo( 230.00000000000452 , 258.5000004110236 )
    shape.absarc( 232.4999981323197 , 258.5000004110305 , 2.4999981323151554 , 3.1415926535925442 , 4.712388980383223 , false )
    shape.lineTo( 237.50000000000702 , 256.00000227870174 )
    shape.absarc( 237.49999999999986 , 253.5000022787017 , 2.5000000000000706 , 1.5707963267920315 , 2.2648549702353193e-14 , true )
    shape.lineTo( 239.99999999999991 , 199.14375462726173 )
    shape.absarc( 224.99999999999386 , 199.14375462726053 , 15.00000000000606 , 7.949196856316121e-14 , 4.633849159492558 , true )
    shape.lineTo( 150.00000000001822 , 190.00000000000904 )
    shape.lineTo( 58.263456353433874 , 189.99999999999253 )
    shape.absarc( 58.263456353432204 , 191.50000243805843 , 1.5000024380659096 , 4.7123889803858034 , 3.926990816988129 , true )
    shape.lineTo( 53.83596499161001 , 193.80617000838782 )
    shape.absarc( 55.60373290121812 , 195.57393791799325 , 2.5000013528938303 , 3.926990816986482 , 2.879793029830126 , true )
    shape.lineTo( 54.57350017855072 , 201.38831566632652 )
    shape.absarc( 56.022388840901925 , 201.00008675290158 , 1.5000000150363184 , 2.8797930298308576 , 1.5782590348486347 , true )
    shape.absarc( 56.00000093137908 , 204.0000022989548 , 1.4999990686209332 , 4.719851688442429 , 3.6188829710681603e-12 , false )
    shape.lineTo( 57.500000000014666 , 205.00000186768253 )
    shape.absarc( 55.00000186770203 , 205.0000018676829 , 2.49999813231263 , 6.283185307179439 , 1.5707963267949305 , false )
    shape.lineTo( 47.77667938788068 , 207.49999999999912 )
    shape.absarc( 47.776679387883206 , 204.99999939814046 , 2.5000006018586487 , 1.5707963267959084 , 2.879793245615443 , false )
    shape.lineTo( 42.58518569817728 , 195.28434260564802 )
    shape.absarc( 45.00000736194332 , 194.63729303878546 , 2.500007361943323 , 2.879793245625544 , 3.1415926536013665 , false )
    shape.lineTo( 42.49999999999999 , 186.49999887938293 )
    shape.absarc( 43.99999887938964 , 186.4999988793852 , 1.4999988793896537 , 3.141592653591309 , 4.712388980384756 , false )
    shape.lineTo( 47.8786786465397 , 184.99999999999324 )
    shape.absarc( 47.878678646540585 , 183.4999975619203 , 1.5000024380729071 , 1.5707963267954885 , 0.7853981634029314 , true )
    shape.lineTo( 51.06065945768307 , 182.43934054232173 )
    shape.absarc( 49.9999975619342 , 181.3786786465704 , 1.5000024380621608 , 0.7853981633986105 , 6.283185307176138 , true )
    shape.lineTo( 51.49999999999283 , 174.99999813231094 )
    shape.absarc( 49.000001867680794 , 174.99999813231207 , 2.4999981323120393 , 6.2831853071791315 , 4.712388980384417 , true )
    shape.lineTo( 32.750001626227466 , 172.50000000000222 )
    shape.absarc( 31.2500016262311 , 172.50000000000222 , 1.4999999999963656 , 0 , 3.141592653589793 , true )
    shape.lineTo( 17.499996264614303 , 172.49999999999744 )
    shape.absarc( 17.499996264619668 , 177.49999626461712 , 4.999996264619675 , 4.712388980383617 , 3.1415926535880936 , true )
    shape.lineTo( 12.499999999999993 , 196.00000112061463 )
    shape.absarc( 13.999998879388777 , 196.00000112061323 , 1.4999988793887833 , 3.1415926535888645 , 1.5707963267919784 , true )
    shape.lineTo( 17.016644714094582 , 197.49999999999312 )
    shape.absarc( 17.016644714093342 , 199.00000388122538 , 1.500003881232255 , 4.712388980385517 , 6.108652400133458 , false )
    shape.lineTo( 19.962020165712605 , 207.06588093973784 )
    shape.absarc( 17.500001899032867 , 207.50000114106686 , 2.4999988589330715 , 6.108652400133597 , 1.5707963267980698 , false )
    shape.lineTo( 2.5 , 210.00000000000222 )
    shape.absarc( 2.4999999999998024 , 207.50000000000242 , 2.4999999999998024 , 1.5707963267948173 , 3.1415926535898273 , false )

    let arcPoints = [
        {
            "x": 5750,
            "y": 5750,
            "z": 0
        },
        {
            "x": 5724.55307910436,
            "y": 5770.171705360458,
            "z": 0
        },
        {
            "x": 5698.5638910000225,
            "y": 5789.639771055218,
            "z": 0
        },
        {
            "x": 5672.0518864144715,
            "y": 5808.389626869966,
            "z": 0
        },
        {
            "x": 5645.036907359478,
            "y": 5826.407240110249,
            "z": 0
        },
        {
            "x": 5617.539172281015,
            "y": 5843.67912610376,
            "z": 0
        },
        {
            "x": 5589.579260927451,
            "y": 5860.192358292491,
            "z": 0
        },
        {
            "x": 5561.17809894733,
            "y": 5875.934577907177,
            "z": 0
        },
        {
            "x": 5532.35694222828,
            "y": 5890.8940032167975,
            "z": 0
        },
        {
            "x": 5503.137360988765,
            "y": 5905.059438346209,
            "z": 0
        },
        {
            "x": 5473.541223634588,
            "y": 5918.420281655328,
            "z": 0
        },
        {
            "x": 5443.590680392218,
            "y": 5930.966533673562,
            "z": 0
        },
        {
            "x": 5413.308146731205,
            "y": 5942.688804583575,
            "z": 0
        },
        {
            "x": 5382.716286588085,
            "y": 5953.578321248784,
            "z": 0
        },
        {
            "x": 5351.837995404318,
            "y": 5963.62693377931,
            "z": 0
        },
        {
            "x": 5320.696382990976,
            "y": 5972.827121631489,
            "z": 0
        },
        {
            "x": 5289.314756232988,
            "y": 5981.171999236368,
            "z": 0
        },
        {
            "x": 5257.716601645883,
            "y": 5988.655321152976,
            "z": 0
        },
        {
            "x": 5225.9255677981155,
            "y": 5995.271486742515,
            "z": 0
        },
        {
            "x": 5193.965447612084,
            "y": 6001.015544359961,
            "z": 0
        },
        {
            "x": 5161.860160557131,
            "y": 6005.883195059964,
            "z": 0
        },
        {
            "x": 5129.6337347478275,
            "y": 6009.870795814246,
            "z": 0
        },
        {
            "x": 5097.310288960936,
            "y": 6012.975362238094,
            "z": 0
        },
        {
            "x": 5064.914014584541,
            "y": 6015.194570823934,
            "z": 0
        },
        {
            "x": 5032.4691575128145,
            "y": 6016.526760680272,
            "z": 0
        },
        {
            "x": 5000,
            "y": 6016.970934774736,
            "z": 0
        },
        {
            "x": 4967.530842487186,
            "y": 6016.526760680272,
            "z": 0
        },
        {
            "x": 4935.085985415459,
            "y": 6015.194570823934,
            "z": 0
        },
        {
            "x": 4902.689711039064,
            "y": 6012.975362238094,
            "z": 0
        },
        {
            "x": 4870.366265252173,
            "y": 6009.870795814246,
            "z": 0
        },
        {
            "x": 4838.139839442869,
            "y": 6005.883195059964,
            "z": 0
        },
        {
            "x": 4806.034552387917,
            "y": 6001.015544359961,
            "z": 0
        },
        {
            "x": 4774.074432201885,
            "y": 5995.271486742515,
            "z": 0
        },
        {
            "x": 4742.283398354117,
            "y": 5988.655321152976,
            "z": 0
        },
        {
            "x": 4710.685243767013,
            "y": 5981.171999236368,
            "z": 0
        },
        {
            "x": 4679.3036170090245,
            "y": 5972.827121631489,
            "z": 0
        },
        {
            "x": 4648.162004595683,
            "y": 5963.62693377931,
            "z": 0
        },
        {
            "x": 4617.283713411916,
            "y": 5953.578321248784,
            "z": 0
        },
        {
            "x": 4586.691853268796,
            "y": 5942.688804583575,
            "z": 0
        },
        {
            "x": 4556.409319607783,
            "y": 5930.966533673562,
            "z": 0
        },
        {
            "x": 4526.458776365412,
            "y": 5918.420281655328,
            "z": 0
        },
        {
            "x": 4496.862639011235,
            "y": 5905.059438346209,
            "z": 0
        },
        {
            "x": 4467.643057771721,
            "y": 5890.8940032167975,
            "z": 0
        },
        {
            "x": 4438.821901052671,
            "y": 5875.934577907178,
            "z": 0
        },
        {
            "x": 4410.420739072549,
            "y": 5860.192358292492,
            "z": 0
        },
        {
            "x": 4382.460827718985,
            "y": 5843.67912610376,
            "z": 0
        },
        {
            "x": 4354.9630926405225,
            "y": 5826.407240110249,
            "z": 0
        },
        {
            "x": 4327.948113585529,
            "y": 5808.389626869967,
            "z": 0
        },
        {
            "x": 4301.436108999978,
            "y": 5789.639771055218,
            "z": 0
        },
        {
            "x": 4275.446920895641,
            "y": 5770.171705360459,
            "z": 0
        },
        {
            "x": 4250,
            "y": 5750,
            "z": 0
        }
    ];

    let arcPointVectors = arcPoints.map((point) => new THREE.Vector3(point.x * 5, point.y * 5, point.z));

    let extrudePaths = [];
    for (let i = 0; i < arcPointVectors.length - 1; i++) {
        extrudePaths.push(
            new THREE.LineCurve3( 
                arcPointVectors[i],
                arcPointVectors[i + 1]
            )
        )
    }

    extrudePaths.push(new THREE.LineCurve3(
        new THREE.Vector3(4250 * 5, 5750 * 5, 0),
        new THREE.Vector3(4250 * 5, 4250 * 5, 0)
    ));
    extrudePaths.push(new THREE.LineCurve3(
        new THREE.Vector3(4250 * 5, 4250 * 5, 0),
        new THREE.Vector3(5750 * 5, 4250 * 5, 0)
    ));
    extrudePaths.push(new THREE.LineCurve3(
        new THREE.Vector3(5750 * 5, 4250 * 5, 0),
        new THREE.Vector3(5750 * 5, 5750 * 5, 0)
    ));
 
    extrudePaths.forEach((extrudePath) => {
        let extrusionSettings: any = {
            steps: 10,
            bevelEnabled: false,
            extrudePath: extrudePath
        }
    
        let geometry = new THREE.ExtrudeBufferGeometry(shape, extrusionSettings);
        let mesh = new THREE.Mesh(geometry, new THREE.MeshStandardMaterial({ color: 0xffffff, metalness: 0.7, roughness: 0.2}));
        mesh.position.set(-25000, -25000, 0);
        scene.add(mesh);
    });

    let origin = new THREE.Mesh(new THREE.SphereBufferGeometry(100), new THREE.MeshBasicMaterial({color: 'red'}))
    scene.add(origin);

    
}

function onWindowResize() {
    let orthoHeight = 5000;
    let orthoAspect = window.innerWidth / window.innerHeight;
    camera.left = -orthoHeight * orthoAspect;
    camera.right = orthoHeight * orthoAspect;
    camera.top = orthoHeight;
    camera.bottom = -orthoHeight;
    camera.updateProjectionMatrix();

    renderer.setSize( window.innerWidth, window.innerHeight );

    render();
}

function render() {

    renderer.render( scene, camera );

}